---
const cur = Astro.url.pathname;
const links = [
  { href: '/', label: 'Inicio' },
  { href: '/vender', label: 'Vender Ahora' },
  { href: '/tarifas', label: 'Tarifas y Materiales' },
  { href: '/como-funciona', label: 'Como Funciona' },
  { href: '/zonas', label: 'Zonas de Cobertura' },
  { href: '/nosotros', label: 'Nosotros' },
  { href: '/blog', label: 'Blog' },
  { href: '/contacto', label: 'Contacto' },
];
const waUrl = 'https://wa.me/56933301114?text=Hola%20Exportandes%2C%20quiero%20vender%20mi%20material.';
---

<header id="nav" class="sticky top-0 z-40 bg-white/95 backdrop-blur border-b border-neutral-dark transition-shadow">
  <nav class="container-x flex items-center justify-between h-16" aria-label="Principal">
    <!-- Logo -->
    <a href="/" class="font-display font-extrabold text-lg tracking-tight text-base">
      export<span class="text-accent">andes</span>
    </a>

    <!-- Desktop links -->
    <ul class="hidden xl:flex items-center gap-1">
      {links.map((l) => (
        <li>
          <a
            href={l.href}
            class:list={[
              'px-3 py-2 text-[13px] font-medium rounded-md transition-colors',
              cur === l.href || (l.href !== '/' && cur.startsWith(l.href))
                ? 'text-accent bg-accent/5'
                : 'text-base-light hover:text-accent hover:bg-accent/5',
            ]}
          >
            {l.label}
          </a>
        </li>
      ))}
    </ul>

    <div class="flex items-center gap-3">
      <!-- Desktop CTA -->
      <a href={waUrl} target="_blank" rel="noopener" class="hidden md:inline-flex btn-primary text-xs px-4 py-2">
        Vender ahora
      </a>

      <!-- Mobile toggle -->
      <button id="menu-toggle" class="xl:hidden p-2 -mr-2 text-base hover:text-accent" aria-label="Menu" aria-expanded="false">
        <svg id="ico-open" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M4 6h16M4 12h16M4 18h16"/></svg>
        <svg id="ico-close" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" class="hidden"><path d="M18 6L6 18M6 6l12 12"/></svg>
      </button>
    </div>
  </nav>

  <!-- Mobile menu -->
  <div id="mobile-menu" class="xl:hidden hidden border-t border-neutral-dark bg-white">
    <ul class="container-x py-4 space-y-1">
      {links.map((l) => (
        <li>
          <a
            href={l.href}
            class:list={[
              'block px-3 py-2.5 text-sm rounded-md transition-colors',
              cur === l.href || (l.href !== '/' && cur.startsWith(l.href))
                ? 'text-accent bg-accent/5 font-medium'
                : 'text-base-light hover:text-accent',
            ]}
          >
            {l.label}
          </a>
        </li>
      ))}
      <li class="pt-3">
        <a href={waUrl} target="_blank" rel="noopener" class="btn-whatsapp w-full text-sm">Vender por WhatsApp</a>
      </li>
    </ul>
  </div>
</header>

<script>
  const btn = document.getElementById('menu-toggle');
  const menu = document.getElementById('mobile-menu');
  const open = document.getElementById('ico-open');
  const close = document.getElementById('ico-close');
  btn?.addEventListener('click', () => {
    const expanded = btn.getAttribute('aria-expanded') === 'true';
    btn.setAttribute('aria-expanded', String(!expanded));
    menu?.classList.toggle('hidden');
    open?.classList.toggle('hidden');
    close?.classList.toggle('hidden');
  });
</script>
