---
import prices from '../../data/prices.json';

interface Props {
  filter?: string;
}
const { filter } = Astro.props;
const items = filter ? prices.filter(p => p.category === filter) : prices;
---

<div class="overflow-x-auto">
  <table class="w-full text-left text-sm" role="table">
    <thead>
      <tr class="border-b-2 border-base/10">
        <th class="py-3 pr-4 font-display font-semibold text-xs uppercase tracking-widest text-base-light">Material</th>
        <th class="py-3 px-4 font-display font-semibold text-xs uppercase tracking-widest text-base-light">Precio compra</th>
        <th class="py-3 px-4 font-display font-semibold text-xs uppercase tracking-widest text-base-light hidden sm:table-cell">Condiciones</th>
        <th class="py-3 pl-4 font-display font-semibold text-xs uppercase tracking-widest text-base-light text-right">Accion</th>
      </tr>
    </thead>
    <tbody>
      {items.map((item) => {
        const waMsg = encodeURIComponent(`Hola Exportandes, quiero vender ${item.name}. Favor indicar cotizacion y retiro.`);
        return (
          <tr class="border-b border-neutral-dark hover:bg-accent/[0.02] transition-colors">
            <td class="py-4 pr-4">
              <span class="font-medium text-base">{item.name}</span>
            </td>
            <td class="py-4 px-4">
              <span class="font-mono font-bold text-base text-lg">${item.price.toLocaleString('es-CL')}</span>
              <span class="text-base-light text-xs ml-1">/{item.unit.split('/')[1]}</span>
              {item.trend === 'up' && (
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#2da77a" stroke-width="3" class="inline ml-1" aria-label="Alza"><path d="M18 15l-6-6-6 6"/></svg>
              )}
            </td>
            <td class="py-4 px-4 text-base-light text-xs hidden sm:table-cell">{item.conditions}</td>
            <td class="py-4 pl-4 text-right">
              <a
                href={`https://wa.me/56933301114?text=${waMsg}`}
                target="_blank"
                rel="noopener"
                class="inline-flex items-center gap-1.5 text-xs font-display font-semibold text-accent hover:text-accent-hover transition-colors"
              >
                Vender
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
              </a>
            </td>
          </tr>
        );
      })}
    </tbody>
  </table>
</div>
